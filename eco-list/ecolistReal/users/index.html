<!DOCTYPE html>
<html lang="en">
<head>
    <title>EcoList - Login</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Cameron Lay">
    <link rel="shortcut icon" href="../images/favicon.ico" type="image/x-icon">
    <link rel="icon" href="../images/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="style.css">
    <script src="script.js"></script>
    <link rel="stylesheet" href="../fonts/font.css">
    
</head>
<body>
    <nav class="navbar navbar-inverse navbar-fixed-top indexNavNoBorderRadius indexNavBackground">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>                      
                </button>
                <a class="navbar-brand" href="../"><img class="indexNavLogo" src="../images/logo.png" alt="Logo"><div class="indexNavLogoText">EcoList</div></a>
                <div id="t" style="font-size:15px;color:#e6e6d8;padding-top:15px;position:absolute;right:20px"></div>
            </div>
            <div class="collapse navbar-collapse" id="myNavbar">
                <ul class="nav navbar-nav">
                    <!-- DROPDOWN MENU -->
                    <li class="dropdown">
                        <a class="dropdown-toggle" data-toggle="dropdown" href="javascript:void(0);">Apps<span class="caret"></span></a>
                        <ul class="dropdown-menu">
                            <li><a href="../ecolist/">EcoList</a></li>
                            <li><a href="../ecoeats/">EcoEats</a></li>
                            <li><a href="../donation/">Donation</a></li>
                        </ul>
                    </li>
                    <!-- FINISH DROPDOWN MENU -->
                    <li><a href="../services/">Services</a></li>
                    <li><a href="../ourfriends/">Our Friends</a></li>
                    <li><a href="../aboutus/">About Us</a></li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li id="p" style="display:none;font-size:15px;color:#e6e6d8;padding-top:15px"></li>
                    <!-- WILL BE DISAPPEARED WHEN USER ISN'T LOGGED IN -->
                    <li><a href="./" onclick="logOut()" id="logOut"><span class="glyphicon glyphicon-log-out"></span>&nbsp;Log Out</a></li>
                    <!-- WILL BE CHANGED TO PHP VARIABLE FOR USER NAME -->
                    <li><a href="../users/" id="logIn"><span class="glyphicon glyphicon-log-in"></span>&nbsp;Login/Sign up</a></li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="container panel panel-default">
        <div class="row">
            <div class="col-md-2"></div>
            <div class="col-md-8" id="LoginLogo">
                <a href="#"><img class="loginLogo" src ="../images/logotext.png" alt="Logo"/></a>
            </div>
        </div>
        <div class="row" id="FormContent">
            <div class="col-md-2"></div>

            <!--Start of the login form-->
            <div class="col-md-4 toggleForm" id="LoginLeft">
                <div id="LoginForm">
                    <table id="LoginTable">
                        <tbody>
                        <tr>
                            <td><input type="text" id="LoginUsername" name="username" placeholder="Username" class="form-control"/></td>
                        </tr>
                        <tr>
                            <td class="spacingRow">Just here for spacing</td>
                        </tr>
                        <tr>
                            <td><input type="password" placeholder="Password" id="Password" name="password" class="form-control"/></td>
                        </tr>
                        <tr>
                            <td class="spacingRow">Just here for spacing</td>
                        </tr>
                        <tr class="submitButton">
                            <td><input id="LoginButton" name="submit" value="Login" type="submit" class="btn btn-info"/></td>
                        </tr>
                        <tr>
                            <td class="spacingRow">Just here for spacing</td>
                        </tr>
                        <tr>
                            <td><input type="button" value="Sign-Up" onclick="SignUpShow()" id="RegisterButton" class="btn btn-info"/></td>
                        </tr>
                        </tbody>
                    </table>
                    <div id="firebaseui-auth-container"></div>
                </div>
            </div>

            <!--Start of the Registration Form-->
            <div class="col-md-5 toggleForm"  id="SignupRight">
                <div id="SignupForm">
                    <table id="SignupTable">
                        <tbody>
                        <tr>
                            <td><input type="email" placeholder="Email" onblur="warnEmailType()" id="Email" name="email" class="form-control" required/></td>
                        </tr>
                        <tr>
                            <td id="ErrEmail">Please enter a valid email</td>
                        </tr>
                        <tr>
                            <td><input type="text" id="SignupUsername" placeholder="Username" name="username" onblur="warnUsername()" class="form-control" required/></td>
                        </tr>
                        <tr>
                            <td id="ErrUsername">Please enter a valid username</td>
                        </tr>
                        <tr>
                            <td><input type="password" placeholder="Password" onblur="warnPassword()" id="SignupPassword" name="password" class="form-control" required/></td>
                        </tr>
                        <tr>
                            <td id="ErrPassword">Password must be between 8 and 16 characters in length</td>
                        </tr>
                        <tr>
                            <td><input type="password" placeholder="Confirm Password" onblur="warnConfirm()" id="Password2" name="password" class="form-control" required/></td>
                        </tr>
                        <tr>
                            <td id="ErrConfirm">Does not match password</td>
                        </tr>
                        <tr class="submitButton">
                            <td><input id="SignupButton" name="submit" value="Register" type="submit" class="btn btn-info"/></td>
                        </tr>
                        <tr>
                            <td class="spacingRow">Sign Up Failed</td>
                        </tr>
                        <tr>
                            <td><input type="button" value="Sign-In" onclick="LoginShow()" id="SignInButton" class="btn btn-info"/></td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
<footer>
        <div class="container-fluid textCentered">
            <table>
                <tr>
                    <td><a href="../">Home</a></td>
                    <td><a href="../ecolist/">EcoList</a></td>
                    <td><a href="../services/">Affiliated Apps</a></td>
                    <td><a href="./">Login</a></td>
                </tr>
                <tr>
                    <td><a href="../#OurPurpose">Our Purpose</a></td>
                    <td><a href="../ecoeats/">EcoEats</a></td>
                    <td><a href="../#AboutUs">About Us</a></td>
                    <td><a href="../sitemap/">Site Map</a></td>
                </tr>
                <tr>
                    <td><a href="../#OurApps">About our Apps</a></td>
                    <td><a href="../donation/">Donation</a></td>
                    <td><a href="../#AboutProject">About the Project</a></td>
                </tr>
                <tr>
                    <td colspan="4"><br>&copy; Copyright 2017 | EcoList, All Rights Reserved</td>
                </tr>
            </table>
        </div>
    </footer>


<!-- Below is the initialisation code for firebase project.-->
<script src="https://www.gstatic.com/firebasejs/3.9.0/firebase.js"></script>
<script src="../loginscript.js"></script>



<!-- The code below initialise the sign in widget. -->
<script src="https://cdn.firebase.com/libs/firebaseui/1.0.1/firebaseui.js"></script>
    <link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/1.0.1/firebaseui.css" />
    <script type="text/javascript">
      // FirebaseUI config.
      var uiConfig = {
        signInSuccessUrl: '../',

        signInOptions: [
          // Leave the lines as is for the providers you want to offer your users.
          firebase.auth.GoogleAuthProvider.PROVIDER_ID
          //firebase.auth.EmailAuthProvider.PROVIDER_ID
        ],
        // Terms of service url.
        tosUrl: '<your-tos-url>'
      };
	  
      // Initialize the FirebaseUI Widget using Firebase.
      var ui = new firebaseui.auth.AuthUI(firebase.auth());
      // The start method will wait until the DOM is loaded.
      ui.start('#firebaseui-auth-container', uiConfig);
		
    </script>



    <!-- EDMUND, EMAIL LOGIN AND SIGNUP -->
    <script>
        var emailSignUpEmail = document.getElementById('Email');
        var emailSignUpName = document.getElementById('SignupUsername');
        var emailSignUpPassword = document.getElementById('SignupPassword');
        var emailLogInEmail = document.getElementById('LoginUsername');
        var emailLogInPassword = document.getElementById('Password');
        var emailLogInBtn = document.getElementById('LoginButton');
        var emailSignUpBtn = document.getElementById('SignupButton');

        // ADD LOGIN EVENT
        emailLogInBtn.addEventListener('click', e => {

            // GET VALUE FROM ID
            var email = emailLogInEmail.value;
            var password = emailLogInPassword.value;

            // SIGN IN
            firebase.auth().signInWithEmailAndPassword(email, password).then(function() {

                // REDIRECT TO HOMEPAGE
                window.location.href = "../";

            }).catch(function(error) {

                alert(error);

            })

        });

        // ADD SIGNUP EVENT
        emailSignUpBtn.addEventListener('click', e => {
            var email = emailSignUpEmail.value;
            var name = emailSignUpName.value;
            var password = emailSignUpPassword.value;
            
            // IF USER INPUT IS INVALID, DO NOT RUN THE FUNCTION
            if (testEmailValid() && testUsername()
                && testPassword() && testConfirm()) {

                // SIGN IN
                firebase.auth().createUserWithEmailAndPassword(email, password).then(function() {

                    // UPDATE PROFILE USING USER NAME
                firebase.auth().currentUser.updateProfile({
                        displayName:name
                    });

                    // REDIRECT TO HOMEPAGE
                    window.location.href = "../";

                    // ONAUTHSTATECHANGED FUNCTION SHOULD RUN AUTOMATICALLY

                    // CATCH ANY ERRORS
                    
                }).catch(function(error) {
                
                    alert(error);

                });
            }

        });

    </script>